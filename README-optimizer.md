# 9. 옵티마이저와 인덱스

- 옵티마이저: 쿼리를 최적으로 실행하기 위해, 실행 계획을 수립하는 작업을 담당한다.

## 9.1 개요

### 9.1.1 쿼리 실행절차

- MySQL 서버에서 쿼리가 실행되는 절차는 크게 세 단계로 나뉜다.
  - 쿼리를 MySQL 서버가 이해할 수 있도록 파싱한다.
  - 파싱된 정보로 어떤 테이블부터 읽고 어떤 인덱스를 이용해 테이블을 읽을지 선택한다. (옵티마이저)
    - 불필요한 조건 제거 & 복잡한 연산 단순화
    - 테이블 조인이 있는 경우 어떤 순서로 읽을지 결정
    - 조건절과 인덱스 정보를 이용해 어떤 인덱스를 사용할지 결정
    - 읽어온 레코드들을 임시 테이블에 넣고 다시 한번 가공할지 결정
  - 수립된 계획으로 스토리지 엔진으로부터 데이터를 가져온다.

### 9.1.2 옵티마이저 종류

- 현재의 DBMS가 선택하는 비용기반 최적화(CBO), 과거의 규칙기반 최적화(RBO)로 나뉜다.
  - 규칙기반 최적화는 테이블의 레코드 건수나 카디널리티 등을 고려하지 않고 옵티마이저에 내장된
    우선 순위에 따라 실행 계획을 수립, 현재는 사용되지 않는다.
  - 비용기반 최적화는 쿼리를 처리하기 위한 여러가지 방법을 만들고, 각 작업의 부하와 통계 정보를 이용해
    여러 방법의 비용을 산출한다. 그 후 비용이 최소로 소요되는 방식을 택한다.

